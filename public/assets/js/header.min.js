/******/ (() => { // webpackBootstrap
/*!********************************!*\
  !*** ./resources/js/header.js ***!
  \********************************/
// Header Search Functionality
document.addEventListener('DOMContentLoaded', function () {
  var input = document.getElementById('product-search-input');
  var dropdown = document.getElementById('search-results-dropdown');
  var timeout = null;
  if (!input || !dropdown) return;
  input.addEventListener('input', function () {
    clearTimeout(timeout);
    var query = this.value.trim();
    if (query.length < 2) {
      dropdown.style.display = 'none';
      dropdown.innerHTML = '';
      return;
    }
    timeout = setTimeout(function () {
      fetch("/search/products?q=".concat(encodeURIComponent(query))).then(function (res) {
        return res.json();
      }).then(function (products) {
        if (products.length === 0) {
          dropdown.innerHTML = '<div class="no-results">Nenhum produto encontrado.</div>';
        } else {
          dropdown.innerHTML = products.map(function (product) {
            var _product$image, _product$sku;
            return "\n                            <a class=\"search-result-item\" href=\"".concat(product.url, "\">\n                                <img src=\"").concat((_product$image = product.image) !== null && _product$image !== void 0 ? _product$image : '/images/no-image.png', "\" alt=\"").concat(product.name, "\" width=\"70\" height=\"70\">\n                                <div>\n                                    <strong>").concat(product.name, "</strong><br>\n                                    <span>").concat((_product$sku = product.sku) !== null && _product$sku !== void 0 ? _product$sku : '', "</span>\n                                </div>\n                            </a>\n                        ");
          }).join('');
        }
        dropdown.style.display = 'block';
      })["catch"](function (error) {
        console.error('Error searching products:', error);
        dropdown.innerHTML = '<div class="no-results">Erro ao buscar produtos.</div>';
        dropdown.style.display = 'block';
      });
    }, 300); // debounce
  });

  // Hide dropdown when clicking outside
  document.addEventListener('click', function (e) {
    if (!dropdown.contains(e.target) && e.target !== input) {
      dropdown.style.display = 'none';
    }
  });

  // Hide dropdown when pressing Escape
  document.addEventListener('keydown', function (e) {
    if (e.key === 'Escape') {
      dropdown.style.display = 'none';
      input.blur();
    }
  });
});

// Enhanced Dropdown Menus Functionality
document.addEventListener('DOMContentLoaded', function () {
  var dropdownMenus = document.querySelectorAll('.dropdown-menu');
  var activeDropdown = null;
  var hoverTimeout = null;
  var closeTimeout = null;
  var HOVER_DELAY = 150;
  var CLOSE_DELAY = 300;

  // Enhanced function to close all dropdowns with smooth animation
  function closeAllDropdowns() {
    var immediate = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;
    if (closeTimeout) {
      clearTimeout(closeTimeout);
      closeTimeout = null;
    }
    dropdownMenus.forEach(function (menu) {
      var content = menu.querySelector('.dropdown-content');
      var trigger = menu.querySelector('.dropdown-trigger');
      var arrow = trigger === null || trigger === void 0 ? void 0 : trigger.querySelector('img');
      if (content && content.classList.contains('show')) {
        // Remove show class to trigger closing animation
        content.classList.remove('show');
        content.classList.add('closing');
        menu.classList.remove('active', 'opening');
        menu.classList.add('closing');
        if (trigger) {
          trigger.classList.remove('active');
        }
        if (arrow) {
          arrow.style.transform = 'rotate(0deg)';
        }

        // Hide after animation completes
        var delay = immediate ? 0 : 250;
        setTimeout(function () {
          if (!content.classList.contains('show')) {
            content.style.display = 'none';
            content.classList.remove('closing');
            menu.classList.remove('closing');
          }
        }, delay);
      }
    });
    activeDropdown = null;
  }

  // Enhanced function to open a specific dropdown
  function openDropdown(menu) {
    var withDelay = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
    if (hoverTimeout) {
      clearTimeout(hoverTimeout);
      hoverTimeout = null;
    }
    var executeOpen = function executeOpen() {
      // Close others first
      closeAllDropdowns(true);
      var content = menu.querySelector('.dropdown-content');
      var trigger = menu.querySelector('.dropdown-trigger');
      var arrow = trigger === null || trigger === void 0 ? void 0 : trigger.querySelector('img');
      if (content) {
        // Prepare for opening animation
        content.style.display = 'block';
        content.classList.remove('closing');
        menu.classList.remove('closing');
        menu.classList.add('active', 'opening');
        activeDropdown = menu;
        if (trigger) {
          trigger.classList.add('active');
        }
        if (arrow) {
          arrow.style.transform = 'rotate(180deg)';
        }

        // Trigger opening animation
        requestAnimationFrame(function () {
          content.classList.add('show');
          setTimeout(function () {
            menu.classList.remove('opening');
          }, 250);
        });
      }
    };
    if (withDelay) {
      hoverTimeout = setTimeout(executeOpen, HOVER_DELAY);
    } else {
      executeOpen();
    }
  }

  // Enhanced toggle function
  function toggleDropdown(menu) {
    var content = menu.querySelector('.dropdown-content');
    var isOpen = content && content.classList.contains('show');
    if (isOpen) {
      closeAllDropdowns();
    } else {
      openDropdown(menu);
    }
  }

  // Function to schedule closing with delay
  function scheduleClose() {
    var delay = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : CLOSE_DELAY;
    if (closeTimeout) {
      clearTimeout(closeTimeout);
    }
    closeTimeout = setTimeout(function () {
      closeAllDropdowns();
    }, delay);
  }

  // Function to cancel scheduled close
  function cancelScheduledClose() {
    if (closeTimeout) {
      clearTimeout(closeTimeout);
      closeTimeout = null;
    }
  }

  // Enhanced event listeners for each dropdown
  dropdownMenus.forEach(function (menu) {
    var trigger = menu.querySelector('.dropdown-trigger');
    var content = menu.querySelector('.dropdown-content');
    if (trigger) {
      // Click handler - works on all devices
      trigger.addEventListener('click', function (e) {
        e.preventDefault();
        e.stopPropagation();
        cancelScheduledClose();
        toggleDropdown(menu);
      });

      // Touch handlers for better mobile experience
      menu.addEventListener('touchstart', function (e) {
        var isOpen = content && content.classList.contains('show');
        if (!isOpen) {
          e.preventDefault();
          openDropdown(menu);
        }
      }, {
        passive: false
      });
    }
  });

  // Enhanced outside click handler
  document.addEventListener('click', function (e) {
    if (!e.target.closest('.dropdown-menu')) {
      closeAllDropdowns();
    }
  });

  // Enhanced keyboard navigation
  document.addEventListener('keydown', function (e) {
    switch (e.key) {
      case 'Escape':
        closeAllDropdowns();
        break;
      case 'ArrowDown':
        if (activeDropdown) {
          e.preventDefault();
          var firstLink = activeDropdown.querySelector('.dropdown-content a');
          if (firstLink) firstLink.focus();
        }
        break;
    }
  });

  // Handle window resize with debounce
  var resizeTimeout;
  window.addEventListener('resize', function () {
    clearTimeout(resizeTimeout);
    resizeTimeout = setTimeout(function () {
      closeAllDropdowns();
    }, 100);
  });

  // Add focus management for accessibility
  dropdownMenus.forEach(function (menu) {
    var content = menu.querySelector('.dropdown-content');
    if (content) {
      var links = content.querySelectorAll('a');
      links.forEach(function (link, index) {
        link.addEventListener('keydown', function (e) {
          if (e.key === 'ArrowDown' && index < links.length - 1) {
            e.preventDefault();
            links[index + 1].focus();
          } else if (e.key === 'ArrowUp' && index > 0) {
            e.preventDefault();
            links[index - 1].focus();
          } else if (e.key === 'Escape') {
            closeAllDropdowns();
            menu.querySelector('.dropdown-trigger').focus();
          }
        });
      });
    }
  });
});

// Mobile Sidebar Functionality
document.addEventListener('DOMContentLoaded', function () {
  console.log('Initializing sidebar functionality...');
  var mobileMenuBtn = document.getElementById('mobile-menu-btn');
  var sidebar = document.getElementById('mobile-sidebar');
  var sidebarOverlay = document.getElementById('sidebar-overlay');
  var sidebarClose = document.getElementById('sidebar-close');
  var sidebarSectionTriggers = document.querySelectorAll('.sidebar-section-trigger');
  console.log('Sidebar elements found:', {
    mobileMenuBtn: !!mobileMenuBtn,
    sidebar: !!sidebar,
    sidebarOverlay: !!sidebarOverlay,
    sidebarClose: !!sidebarClose,
    sectionTriggers: sidebarSectionTriggers.length
  });

  // Check if elements exist
  if (!mobileMenuBtn || !sidebar) {
    console.warn('Sidebar elements not found');
    return;
  }
  var activeSidebarSection = null;

  // Open sidebar
  function openSidebar() {
    console.log('Opening sidebar...');
    sidebar.classList.add('active');
    mobileMenuBtn.classList.add('active');
    document.body.classList.add('sidebar-open');
  }

  // Close sidebar
  function closeSidebar() {
    console.log('Closing sidebar...');
    sidebar.classList.remove('active');
    mobileMenuBtn.classList.remove('active');
    document.body.classList.remove('sidebar-open');
    closeAllSections();
  }

  // Toggle sidebar section
  function toggleSidebarSection(sectionTrigger) {
    var sectionName = sectionTrigger.dataset.section;
    var sectionContent = document.getElementById("".concat(sectionName, "-content"));
    console.log("Toggling section: ".concat(sectionName), {
      trigger: !!sectionTrigger,
      content: !!sectionContent
    });
    if (!sectionContent) {
      console.warn("Section content not found: ".concat(sectionName, "-content"));
      return;
    }
    var isActive = sectionContent.classList.contains('active');

    // Close all sections first
    closeAllSections();

    // If this section wasn't active, open it
    if (!isActive) {
      console.log("Opening section: ".concat(sectionName));
      sectionTrigger.classList.add('active');
      sectionContent.classList.add('active');
      activeSidebarSection = sectionName;
    } else {
      console.log("Section ".concat(sectionName, " was already active, closing all"));
    }
  }

  // Close all sidebar sections
  function closeAllSections() {
    console.log('Closing all sections...');
    sidebarSectionTriggers.forEach(function (trigger) {
      trigger.classList.remove('active');
      var sectionName = trigger.dataset.section;
      var sectionContent = document.getElementById("".concat(sectionName, "-content"));
      if (sectionContent) {
        sectionContent.classList.remove('active');
      }
    });
    activeSidebarSection = null;
  }

  // Mobile menu button click
  if (mobileMenuBtn) {
    mobileMenuBtn.addEventListener('click', function (e) {
      e.preventDefault();
      e.stopPropagation();
      console.log('Menu button clicked');
      if (sidebar.classList.contains('active')) {
        closeSidebar();
      } else {
        openSidebar();
      }
    });
  }

  // Sidebar close button
  if (sidebarClose) {
    sidebarClose.addEventListener('click', function (e) {
      e.preventDefault();
      console.log('Close button clicked');
      closeSidebar();
    });
  }

  // Overlay click to close
  if (sidebarOverlay) {
    sidebarOverlay.addEventListener('click', function (e) {
      e.preventDefault();
      console.log('Overlay clicked');
      closeSidebar();
    });
  }

  // Section triggers
  sidebarSectionTriggers.forEach(function (trigger, index) {
    console.log("Setting up trigger ".concat(index, ":"), trigger.dataset.section);
    trigger.addEventListener('click', function (e) {
      e.preventDefault();
      e.stopPropagation();
      console.log("Section trigger clicked: ".concat(trigger.dataset.section));
      toggleSidebarSection(this);
    });
  });

  // Keyboard navigation
  document.addEventListener('keydown', function (e) {
    if (e.key === 'Escape' && sidebar.classList.contains('active')) {
      console.log('Escape key pressed, closing sidebar');
      closeSidebar();
    }
  });

  // Close sidebar when clicking on sidebar links (using event delegation for dynamically added links)
  sidebar.addEventListener('click', function (e) {
    var link = e.target.closest('.sidebar-section-content a, .sidebar-link, .sidebar-action-btn');
    if (link) {
      console.log('Sidebar link clicked, closing sidebar');
      // Allow navigation to happen before closing
      setTimeout(function () {
        closeSidebar();
      }, 150);
    }
  });

  // Handle window resize
  window.addEventListener('resize', function () {
    if (window.innerWidth > 768 && sidebar.classList.contains('active')) {
      console.log('Switched to desktop, closing sidebar');
      closeSidebar();
    }
  });

  // Simple touch gesture to close sidebar (swipe left)
  var touchStartX = 0;
  if (sidebar) {
    sidebar.addEventListener('touchstart', function (e) {
      touchStartX = e.touches[0].clientX;
    });
    sidebar.addEventListener('touchend', function (e) {
      var touchEndX = e.changedTouches[0].clientX;
      var deltaX = touchStartX - touchEndX;

      // If swiped left more than 100px, close sidebar
      if (deltaX > 100) {
        console.log('Swipe left detected, closing sidebar');
        closeSidebar();
      }
    });
  }
  console.log('Sidebar initialization complete');
});
/******/ })()
;